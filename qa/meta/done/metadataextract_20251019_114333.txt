# SAP SuccessFactors Metadata Extraction Report
## Queensland Department of Education - Recruitment Management System
### ServiceNow Integration Component

### Executive Summary
This metadata extraction supplement focuses on the critical ServiceNow integration component for over-establishment recruitment approval processes, addressing the gap identified in previous extractions. This integration ensures proper governance and risk management for positions outside funded establishment.

### 1. ServiceNow Integration Data Objects

#### 1.1 ServiceNow Approval Request Object
- **SN_OverEstablishment_Request** - Core approval entity
  - **Key Fields**:
    - request_id (Primary Key) - GUID from ServiceNow
    - sf_requisition_id (Foreign Key) - Links to JobRequisition
    - risk_assessment_completed (Boolean)
    - approval_status (String: Pending/Approved/Rejected)
    - approval_date (DateTime)
    - approver_id (String) - ServiceNow user ID
    - justification_notes (Text) - Business justification for over-establishment
    - cost_impact_assessment (Decimal) - Financial impact analysis
    - duration_requested (Integer) - Months for temporary over-establishment
  - **Temporal Management**: Creation and modification timestamps
  - **Relationships**: Links to JobRequisition, Position MDF object

#### 1.2 ServiceNow Integration Configuration Object
- **Integration_Config** - Integration endpoint management
  - **Key Fields**:
    - config_id (Primary Key)
    - service_now_instance_url (String)
    - api_endpoint_path (String)
    - authentication_method (String: OAuth/Basic)
    - timeout_settings (Integer) - Connection timeout in seconds
    - retry_attempts (Integer) - Number of retry attempts
    - error_notification_email (String) - Email for integration failures
    - sync_frequency_minutes (Integer) - Polling interval
    - last_sync_timestamp (DateTime)
  - **Security**: Encrypted authentication credentials
  - **Monitoring**: Status tracking and error logging

### 2. Integration Process Metadata

#### 2.1 Over-Establishment Workflow Integration
- **Process**: Create Over-Establishment Request
  - **Trigger**: JobRequisition creation with establishmentControl = "Over-Establishment"
  - **Pre-conditions**: 
    - Position status must be "Vacant"
    - establishmentControl must be "Over-Establishment"
    - Risk assessment must be completed in SF
  - **Integration Steps**:
    1. Validate requisition data completeness
    2. Create ServiceNow request with SF requisition details
    3. Map SF fields to ServiceNow fields
    4. Submit approval request to ServiceNow
    5. Wait for approval response (asynchronous)
    6. Update SF requisition status based on ServiceNow response

#### 2.2 Field Mapping Configuration
- **SF to ServiceNow Mapping**:
  ```
  JobRequisition.requisitionId → SN_OverEstablishment_Request.sf_requisition_id
  JobRequisition.title → SN_OverEstablishment_Request.job_title
  JobRequisition.description → SN_OverEstablishment_Request.job_description
  JobRequisition.jobCode → SN_OverEstablishment_Request.job_code
  JobRequisition.positionId → SN_OverEstablishment_Request.position_id
  JobRequisition.establishmentControl → SN_OverEstablishment_Request.establishment_type
  Position.costCenter → SN_OverEstablishment_Request.cost_center
  Position.departmentCode → SN_OverEstablishment_Request.department
  ```

- **ServiceNow to SF Mapping**:
  ```
  SN_OverEstablishment_Request.approval_status → JobRequisition.status
  SN_OverEstablishment_Request.approval_date → JobRequisition.approval_date
  SN_OverEstablishment_Request.approver_id → JobRequisition.approved_by
  SN_OverEstablishment_Request.justification_notes → JobRequisition.approval_notes
  ```

### 3. API Integration Metadata

#### 3.1 ServiceNow REST API Configuration
- **API Endpoint**: `/api/x_qld_edu_over_est/recruitment_approval`
- **Authentication**: OAuth 2.0 with ServiceNow OAuth application
- **Request Method**: POST for new requests, GET for status updates
- **Content-Type**: application/json
- **Rate Limiting**: 100 requests per minute per instance
- **Response Timeout**: 30 seconds

#### 3.2 Request Payload Structure
```json
{
  "sf_requisition_id": "REQ0012345",
  "job_title": "Senior Administrator",
  "job_description": "Administrative role in corporate office",
  "job_code": "ADM001",
  "position_id": "POS0005678",
  "establishment_type": "Over-Establishment",
  "cost_center": "COST12345",
  "department": "CORP_ADMIN",
  "risk_assessment_completed": true,
  "justification_notes": "Temporary coverage for maternity leave",
  "cost_impact_assessment": 85000.00,
  "duration_requested": 6,
  "requestor_email": "hr.manager@education.qld.gov.au",
  "requestor_name": "HR Manager",
  "created_timestamp": "2025-10-19T10:30:00Z"
}
```

#### 3.3 Response Payload Structure
```json
{
  "request_id": "SN_REQ_001234567",
  "status": "success",
  "message": "Approval request created successfully",
  "approval_status": "Pending",
  "estimated_processing_time": "2-3 business days",
  "tracking_url": "https://qldedu.service-now.com/nav_to.do?uri=incident.do?sys_id=001234567"
}
```

### 4. Business Rules for ServiceNow Integration

#### 4.1 Validation Rules
- **Rule**: Validate Over-Establishment Prerequisites
  - **Condition**: JobRequisition.establishmentControl = "Over-Establishment"
  - **Action**: 
    - Check if risk_assessment_completed = true
    - Validate that justification_notes is not null/empty
    - Verify cost_impact_assessment > 0
    - If validation fails, prevent ServiceNow submission
  - **Error Message**: "Over-establishment requests require risk assessment completion, justification, and cost impact analysis"

- **Rule**: Prevent Duplicate ServiceNow Requests
  - **Condition**: JobRequisition.establishmentControl = "Over-Establishment" AND previous ServiceNow request exists
  - **Action**: Check for existing pending request for same requisition
  - **Error Message**: "A ServiceNow approval request already exists for this requisition"

#### 4.2 Status Synchronization Rules
- **Rule**: Update SF Requisition Status from ServiceNow
  - **Trigger**: ServiceNow sends status update webhook
  - **Logic**: 
    - If ServiceNow approval_status = "Approved" → SF status = "Approved"
    - If ServiceNow approval_status = "Rejected" → SF status = "Rejected"
    - If ServiceNow approval_status = "Pending" → SF status remains "In Approval"
  - **Action**: Update JobRequisition.status and log audit trail

### 5. Error Handling and Retry Logic

#### 5.1 Integration Error Types
- **HTTP 4xx Errors**: Client-side errors (invalid request format, authentication)
- **HTTP 5xx Errors**: Server-side errors (ServiceNow unavailable)
- **Timeout Errors**: Request timeout beyond 30 seconds
- **Connection Errors**: Network connectivity issues

#### 5.2 Retry Configuration
- **Retry Strategy**: Exponential backoff (1s, 2s, 4s, 8s, 16s)
- **Maximum Retries**: 5 attempts
- **Retry Conditions**: HTTP 5xx errors, timeout errors, connection errors
- **Non-Retry Conditions**: HTTP 4xx errors (client errors should not be retried)

#### 5.3 Error Handling Process
- **Error Detection**: Monitor HTTP response codes and connection status
- **Logging**: Log all errors with timestamp, error type, and request details
- **Notification**: Send email alerts for integration failures
- **Manual Intervention**: Provide manual retry option for persistent failures

### 6. Security and Compliance Metadata

#### 6.1 Authentication Configuration
- **OAuth Application**: ServiceNow OAuth client registration
- **Client ID**: Generated by ServiceNow instance
- **Client Secret**: Securely stored in SF integration center
- **Token Expiration**: 1 hour with automatic refresh

#### 6.2 Data Encryption
- **Transport Encryption**: TLS 1.2 for all API communications
- **Data Masking**: Sensitive data fields masked in logs
- **Access Logging**: Complete audit trail of integration activities
- **Compliance**: GDPR and Australian Privacy Act compliance

#### 6.3 Access Control
- **Integration User**: Dedicated ServiceNow user with minimal required permissions
- **SF Integration Role**: Specific role with API access permissions
- **Audit Trail**: Complete logging of all integration activities
- **Monitoring**: Real-time monitoring of integration health

### 7. Monitoring and Alerting Metadata

#### 7.1 Key Performance Indicators
- **Integration Success Rate**: Percentage of successful ServiceNow requests
- **Average Processing Time**: Time from SF submission to ServiceNow response
- **Error Rate**: Percentage of failed integration attempts
- **Pending Request Queue**: Number of outstanding ServiceNow requests

#### 7.2 Alert Configuration
- **High Priority**: Integration failures, authentication errors
- **Medium Priority**: High error rates, slow response times
- **Low Priority**: Warning conditions, configuration changes
- **Notification Methods**: Email, SMS, dashboard alerts

### 8. Configuration Dependencies

#### 8.1 Critical Configuration Items
- **ServiceNow Instance URL**: Must be accessible from SF environment
- **OAuth Application**: Properly configured with required scopes
- **Network Connectivity**: Firewall rules allowing communication
- **User Permissions**: Integration users with required access rights

#### 8.2 Testing Requirements
- **Integration Testing**: End-to-end testing of ServiceNow approval process
- **Load Testing**: Performance testing under expected load
- **Error Testing**: Validation of error handling and retry logic
- **Security Testing**: Authentication and data protection validation

### 9. Migration and Deployment Metadata

#### 9.1 Deployment Prerequisites
- ServiceNow instance configured with custom application
- OAuth application created and tested
- Network connectivity established
- Integration users created with appropriate permissions

#### 9.2 Rollout Strategy
- **Phase 1**: Test environment integration setup and validation
- **Phase 2**: Staging environment deployment and user acceptance testing
- **Phase 3**: Production deployment with monitoring and support
- **Phase 4**: Go-live with full operational support

This ServiceNow integration metadata extraction completes the comprehensive view of Queensland Department of Education's recruitment management system, ensuring proper governance for over-establishment recruitment scenarios.