# SAP SuccessFactors Metadata Extraction Report
## E023 - Auto Creation of Net Offset for Overpayments Over Threshold

### Executive Summary
This metadata extraction analyzes the custom overpayment management enhancement for the Queensland Department of Education (DoE) HCMS implementation, focusing on automated net offset creation for overpayments exceeding defined thresholds.

---

## 1. System Context Metadata

### 1.1 Project Information
- **Project**: Human Capital Management System (HCMS) Programme
- **Organization**: Queensland Department of Education
- **Business Unit**: Queensland Department of Education
- **Phase**: Explore Phase
- **Solution Domain**: Employee Central Payroll (ECP)
- **Enhancement ID**: E023

### 1.2 Current State System
- **Legacy System**: TSS (Time and Salary System)
- **Current Feature**: Custom-built Overpayments portal
- **Processing Type**: Manual assessment with auto-recovery capabilities
- **Offset Method**: Gross offset with tax and superannuation adjustments

---

## 2. Enhanced Functionality Metadata

### 2.1 Core Enhancement Objectives
| Enhancement Element | Description | Processing Type |
|-------------------|-------------|-----------------|
| Overpayment Identification | Detection via wage type /652 analysis | Automated |
| Net Offset Creation | Creation of offset equal to overpayment amount | Conditional |
| Total Debt Management | Storage of full overpayment amount | Automated |
| Repayment Deduction | Recurring deduction setup | Configurable |

### 2.2 Key Wage Types
| Wage Type | Purpose | Usage Context |
|-----------|---------|---------------|
| /652 | Stat Net Post Deduction | Overpayment identification |
| Custom Offset Wage Types | Net offset creation | ECP direct creation |
| Total Debt Wage Type | Overpayment storage | Reducing balance deduction |
| Recurring Deduction Wage Type | Payment collection | Periodic recovery |

---

## 3. Data Model Metadata

### 3.1 Custom Foundation Objects Required

#### 3.1.1 Overpayment Threshold Configuration Object
```
Object Name: OverpaymentThresholdConfiguration
Object ID: OverpaymentThresholdConfig
Description: Stores dollar threshold per employee/worker type
Date Effectiveness: Enabled
Key Fields:
  - EmployeeType (Picklist)
  - WorkerCategory (Picklist) 
  - ThresholdAmount (Currency)
  - EffectiveStartDate (Date)
  - EffectiveEndDate (Date)
```

#### 3.1.2 Overpayment Management Object
```
Object Name: OverpaymentManagement
Object ID: OverpaymentMgmt
Description: Tracks overpayment identification and recovery status
Key Fields:
  - EmployeeID (String)
  - OverpaymentAmount (Currency)
  - OverpaymentDate (Date)
  - ThresholdExceeded (Boolean)
  - OffsetCreated (Boolean)
  - TotalDebtCreated (Boolean)
  - RepaymentSetup (Boolean)
  - RecoveryStatus (Picklist)
```

### 3.2 Integration Points
- **Employee Central (EC)**: Master data source
- **Employee Central Payroll (ECP)**: Processing engine
- **Payroll Control Centre**: Monitoring and identification
- **BTP (Business Technology Platform)**: Orchestration

---

## 4. Configuration Metadata

### 4.1 Threshold Configuration Matrix
| Configuration Element | Type | Effective Management |
|----------------------|------|---------------------|
| Employee Cohort | Picklist | Date-effective |
| Dollar Threshold | Currency | Date-effective |
| Worker Type | Picklist | Date-effective |
| Calculation Logic | Formula | Implementation-defined |

### 4.2 Processing Configuration
| Process Step | Timing | Location | Purpose |
|--------------|--------|----------|---------|
| Pre-Payroll | Pre-processing | ECP | Offset creation |
| Live Payroll | During processing | ECP | Offset execution |
| Post-Payroll | Post-processing | ECP | Debt/repayment setup |

---

## 5. Field Definitions and Properties

### 5.1 Overpayment Identification Fields
```
Field: OverpaymentDetected
Type: Boolean
Source: Wage Type /652 existence in current pay period
Validation: Exists in ECP results table

Field: OverpaymentAmount
Type: Currency
Precision: 2 decimal places
Source: Negative value calculation from /652

Field: ThresholdExceeded
Type: Boolean
Calculation: OverpaymentAmount > ConfiguredThreshold
```

### 5.2 Offset Management Fields
```
Field: NetOffsetAmount
Type: Currency
Calculation: Equal to OverpaymentAmount when threshold exceeded
Location: ECP direct creation
Numbering: Dedicated range for program identification

Field: OffsetCreated
Type: Boolean
Status: Track offset creation status
Location: Custom table
```

---

## 6. Business Logic Metadata

### 6.1 Decision Logic
```
IF OverpaymentAmount > ThresholdConfiguredFor(EmployeeType, WorkerCategory)
  THEN CreateNetOffset = OverpaymentAmount
  AND CreateTotalDebt = OverpaymentAmount
  AND SetupRecurringDeduction = TRUE
ELSE 
  AutoRecover = TRUE
```

### 6.2 Processing Rules
- **Master Data Change Tolerance**: Standalone payroll process to accommodate changes
- **Offset Creation Timing**: Pre-payroll or Live-payroll process
- **Debt/Repayment Creation**: Post-payroll process
- **Manual Override**: Remove offset and re-run payroll when employee agrees to current period repayment

---

## 7. Reporting and Monitoring Metadata

### 7.1 Required Reports
| Report Name | Purpose | Frequency | Data Source |
|-------------|---------|-----------|-------------|
| Overpayment Identification | Identify overpayments | Per pay period | ECP wage types |
| Offset Creation Summary | Track automated offsets | Per pay period | Custom tables |
| Recovery Progress | Monitor repayment status | Ongoing | ECP deductions |

### 7.2 Monitoring Objects
- **Payroll Control Centre**: Overpayment visibility
- **Custom Dashboards**: Threshold configuration and processing status
- **Audit Logs**: Offset creation and modification tracking

---

## 8. Integration Metadata

### 8.1 API Requirements
- **OData Services**: ECP integration for offset creation
- **BTP Orchestration**: Process automation and scheduling
- **EC Integration**: Master data synchronization
- **Payroll Control Centre**: Status and monitoring integration

### 8.2 Data Flow
```
EC Master Data → ECP Payroll Processing → Overpayment Detection (/652) 
→ Threshold Comparison → Offset Creation (ECP) → Debt Setup (ECP) 
→ Recurring Deduction (ECP) → Status Update (Custom Tables)
```

---

## 9. Security and Permission Metadata

### 9.1 Role Requirements
| Role | Permissions | Scope |
|------|-------------|-------|
| Payroll Manager | Execute enhancement, override decisions | Payroll process |
| Payroll Advisor | View overpayments, configure thresholds | Employee records |
| System Administrator | Configure threshold matrix, monitor processing | System level |

### 9.2 Data Security
- **Data Sensitivity**: Financial data requiring payroll-level security
- **Access Control**: Role-based access to overpayment information
- **Audit Requirements**: Complete audit trail for offset creation and modifications

---

## 10. Custom Development Metadata

### 10.1 Custom Objects
- **MDF Objects**: Threshold configuration matrix
- **Custom Tables**: Overpayment tracking and status
- **Workflow Enhancements**: Approval for manual overrides
- **Business Rules**: Threshold validation and offset creation logic

### 10.2 Technical Implementation
- **Platform**: SAP BTP for orchestration
- **Integration**: ECP direct wage type creation
- **Numbering**: Dedicated range for program-generated offsets
- **Error Handling**: Process failure and recovery mechanisms

---

## 11. Dependencies and Relationships

### 11.1 System Dependencies
- **EC Foundation Objects**: Employee master data
- **ECP Configuration**: Wage type setup and processing rules
- **Payroll Control Centre**: Monitoring and identification
- **Tax and Superannuation**: Adjustment calculations

### 11.2 Process Dependencies
- **Payroll Processing**: Timing and sequence requirements
- **Master Data Changes**: Accommodation for ongoing changes
- **Manual Processes**: Integration with existing advisor workflows

---

## 12. Implementation Considerations

### 12.1 Configuration Requirements
- **Threshold Matrix**: Must be provided during implementation
- **Calculation Logic**: Deduction amount logic to be defined by DoE
- **Date Effectiveness**: All threshold configurations must support date-effective changes
- **Number Range**: Dedicated ECP number range for offset identification

### 12.2 Performance Considerations
- **Processing Volume**: Number of overpayments expected
- **Timing Requirements**: Integration with payroll schedule
- **Scalability**: Support for varying overpayment volumes
- **Monitoring**: Performance tracking and optimization

This metadata extraction provides comprehensive coverage of the overpayment automation enhancement, supporting system documentation, implementation planning, and ongoing system management.